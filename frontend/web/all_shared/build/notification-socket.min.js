let countCurrentDisplayingNotifications=0,notifLimit=5,notifQueue=[];function notificationInit(t){console.log("notificationInit.start"),console.log(t);let e=null;try{e=t.command}catch(t){return console.error("Invalid data command"),void console.error(t)}if("add"===e)try{notificationAddMessage(t.id,t.title,t.time,t.message,t.type,t.popup,t.notifyMessage,t.notifyDesktopMessage)}catch(t){return console.error("Invalid data for command = add"),void console.error(t)}else if("delete"===e)try{notificationDeleteMessage(t.id)}catch(t){return console.error("Invalid data for command = delete"),void console.error(t)}else"delete_all"===e?notificationDeleteAllMessages():"delete_batch"===e&&t.ids.forEach(function(t){notificationDeleteMessage(parseInt(t))});notificationUpdateTime(),console.log("notificationInit.end")}function notificationDeleteAllMessages(){let t=!1;$("#notification-menu li").each(function(e){$(this).data("id")&&(t=!0,$(this).remove())}),t?(notificationCounterReset(),console.log("Messages was deleted")):console.error("Messages not found")}function notificationDeleteMessage(t){let e=!1,i=$('#notification-menu li[data-id="'+t+'"]');if(i.length){let n=i.data("id");if(n&&n===t)return e=!0,i.remove(),notificationCounterDecrement(),console.log("Message Id: "+t+" was deleted"),!1}e||console.error("Message Id: "+t+" not found")}function notificationIsExist(t){let e=!1;return $("#notification-menu li").each(function(i){let n=$(this).data("id");if(n&&n===t)return e=!0,!1}),e}function notificationAddMessage(t,e,i,n,o,a,c,s){if(notificationIsExist(t))return void console.error("Message Id: "+t+" already exist on UI list");let r='<li data-id="'+t+'"> <a href="javascript:;" onclick="notificationShow(this);" id="notification-menu-element-show" data-title="'+e+'" data-id="'+t+'"><span class="glyphicon glyphicon-info-sign"> </span> <span><span>'+e+'</span><span class="time" data-time="'+i+'">'+i+'</span></span><span class="message">'+n+"<br></span></a></li>";$("#notification-menu").prepend(r),notificationCounterIncrement(),$("#notification-menu li").each(function(t){if(10===t){let t=$(this).data("id");t&&($(this).remove(),console.log("Message Id: "+t+" was delete from UI list"))}}),a&&notificationPNotify(t,o,e,c,s),console.log("Message Id: "+t+" was added")}function notificationCounterIncrement(){$(".notification-counter").each(function(){let t=$(this).text();return t?(t=parseInt(t),t++):t=1,$(".notification-counter").text(t),!1})}function notificationCounterDecrement(){$(".notification-counter").each(function(){let t=$(this).text();return t&&(t=parseInt(t))>1?t--:t="",$(".notification-counter").text(t),!1})}function notificationCounterReset(){$(".notification-counter").text("")}function notificationUpdateTime(){$("#notification-menu li .time").each(function(){$(this).text(notificationTimeDifference(new Date,new Date(1e3*$(this).data("time"))))})}function notificationTimeDifference(t,e){let i=t-e;return i<6e4?Math.round(i/1e3)+" seconds ago":i<36e5?Math.round(i/6e4)+" minutes ago":i<864e5?Math.round(i/36e5)+" hours ago":i<2592e6?Math.round(i/864e5)+" days ago":i<31536e6?Math.round(i/2592e6)+" months ago":Math.round(i/31536e6)+" years ago"}function notificationPNotify(t,e,i,n,o){createNotify(i,n,e),createDesktopNotify(t,i,n,e,o),"visible"===document.visibilityState&&soundNotification()}function notificationCount(t,e){$(".notification-counter").text(t),$("._cc_unread_messages").text(e),e&&"chat"===window.name?faviconChat.badge(e):faviconChat.reset()}function notificationShow(t){let e="/notifications/view2?id="+$(t).data("id"),i=$(t).data("title"),n=$("#modal-lg");return $.get(e,function(t){n.find(".modal-title").html(i),n.find(".modal-body").html(t),n.modal()}),!1}